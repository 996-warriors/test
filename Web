//俞明飞  2019.6.29  版本1

//商品推荐
product_recommend.jsp

<%@ page language="java" contentType="text/html; charset=GB18030"
    pageEncoding="GB18030"%>
<!DOCTYPE html>

<%@ page import="java.util.List" %>
<%@ page import="java.util.ArrayList" %>
<%@ page import="productList.Product" %>

<html>
<head>
<meta charset="GB18030">
<title>商品推荐</title>
</head>
<body>
<table align = "center" width = "450" border="1">
   <tr>
     <td align="center" colspan="5">
       <h4>猜你喜欢</h4>
     </td>
   </tr>
   <tr align="center">
     <td><b>ID</b></td>
     <td><b>名称</b></td>
     <td><b>类别</b></td>
     <td><b>数量</b></td>
     <td><b>描述</b></td>    
    
   </tr>
   
     <%
       //获取商品集合
       List<Product> list = (List<Product>)request.getAttribute("list");
       //判断集合是否有效
       if(list == null||list.size()<1){
    	   out.print("没有数据！");
       }else{
    	   //遍历商品集合中的数据
    	   for(Product product:list){
     %>
         <tr align = "center">
           <td><%=product.getID() %></td>
           <td><%=product.getName() %></td>
           <td><%=product.getType() %></td>
           <td><%=product.getNumber() %></td>
           <td><%=product.getDescrption() %></td>
           
         </tr>
      <% 
    	   }
       }
     %>
  </table>

</body>
</html>


//主页面  index.jsp
<%@ page language="java" contentType="text/html; charset=GB18030"
    pageEncoding="GB18030"%>

<%@ page import="java.util.List" %>
<%@ page import="java.util.ArrayList" %>
<%@ page import="productList.Product" %>

<html>
<head>
<title>开始</title>
</head>
<body background= "images/shop.jpg" width=1100 height=700>
<center>
  <a href = "FindServlet">查看商品</a>
  <a href = "RecommendServlet">猜你喜欢</a>
</center>
</body>
</html>

//删除商品  DeleteServlet.java
package servlet;

import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.Statement;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import productList.sql;

import productList.Product;
import productList.getInfo;
/**
 * Servlet implementation class DeleteServlet
 */
@WebServlet("/DeleteServlet")
public class DeleteServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
       
    /**
     * @see HttpServlet#HttpServlet()
     */
    public DeleteServlet() {
        super();
        // TODO Auto-generated constructor stub
    }

	/**
	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		
		String ID = String.valueOf(request.getParameter("ID"));    //获取商品ID与名称
		//String Name=request.getParameter("Name").trim();
		try {
			sql q = new sql("oracle.jdbc.driver.OracleDriver","jdbc:oracle:thin:@192.168.153.129:1521:SPORTDB",
	                "qiang","Admin147258");
			q.ConnectData();
			
			q.DeleteProduct(ID);
		
			q.CloseConnect();
			q.closeData();
		}catch(Exception e) {
			e.printStackTrace();
		}
		response.sendRedirect("FindServlet");           //重定向到FindServlet
	}

	/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		doGet(request, response);
	}

}

//商品列表  product_list.jsp
<%@ page language="java" contentType="text/html; charset=GB18030"
    pageEncoding="GB18030"%>
<!DOCTYPE html>
<%@ page import="java.util.List" %>
<%@ page import="java.util.ArrayList" %>
<%@ page import="productList.Product" %>

<html>
<head>
<meta charset="GB18030">
<title>商品列表</title>
</head>
<body>
  <table align = "center" width = "450" border="1">
   <tr>
     <td align="center" colspan="5">
       <h4>商品列表如下</h4>
     </td>
   </tr>
   <tr align="center">
     <td><b>ID</b></td>
     <td><b>名称</b></td>
     <td><b>类别</b></td>
     <td><b>数量</b></td>
     <td><b>描述</b></td>    
    
   </tr>
   
     <%
       //获取商品集合
       List<Product> list = (List<Product>)request.getAttribute("list");
       //判断集合是否有效
       if(list == null||list.size()<1){
    	   out.print("没有数据！");
       }else{
    	   //遍历商品集合中的数据
    	   for(Product product:list){
     %>
         <tr align = "center">
           <td><%=product.getID() %></td>
           <td><%=product.getName() %></td>
           <td><%=product.getType() %></td>
           <td><%=product.getNumber() %></td>
           <td><%=product.getDescrption() %></td>
           <td>
             
           </td>
              <form action = "updata.jsp?id=<%=product.getID()%>" method="post" onsubmit="return check(this);">
               <input type = "submit" value="修改">
             </form>
           <td>
             <a href ="DeleteServlet?ID=<%=product.getID()%>">删除</a>
           </td>
         </tr>
      <% 
    	   }
       }
     %>
  </table>
</body>
</html>


//修改商品  updata.jsp
<%@ page language="java" contentType="text/html; charset=GB18030"
    pageEncoding="GB18030"%>
<!DOCTYPE html>
<html>
<head>
<meta charset=GB18030">
<title>修改商品信息</title>
</head>
<body background= "images/updata.jpg" width=1000 height=700>
  <div align="center">
<form action="UpdateServlet" method="post" name=form>
<table>
       <tr><td>商品ID:</td><td><Input type=text name="ID" ></td>
       <td>商品名称:</td><td><Input type=text name="Name">
       </td></tr>
   <tr><td>商品类型:</td><td>
       <Input type=text name="type"></td>
       <td>商品数量:</td><td><Input type=text name="number"></td></tr>
   <tr><td>商品描述:</td><td><Input type=text name="Descrption"></td>
   </tr>
   <tr>
       <td><Input type=submit name="update" value="保存修改"></td>     
    </tr>
</table>
</form>
</div>
</body>
</html>


//UpdateServlet.java

package servlet;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;


import productList.Product;
import productList.sql;

/**
 * Servlet implementation class UpdateServlet
 */
@WebServlet("/UpdateServlet")
public class UpdateServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
       
    /**
     * @see HttpServlet#HttpServlet()
     */
    public UpdateServlet() {
        super();
        // TODO Auto-generated constructor stub
    }

	/**
	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		
		String ID=request.getParameter("ID").trim();
		String Name=request.getParameter("Name").trim();
		String type=request.getParameter("type").trim();
		int number=Integer.valueOf(request.getParameter("number"));
		String Descrption=request.getParameter("Descrption").trim();
		
		try {
			sql q = new sql("oracle.jdbc.driver.OracleDriver","jdbc:oracle:thin:@192.168.153.129:1521:SPORTDB",
	                "qiang","Admin147258");
			q.ConnectData();
			
		q.DeleteProduct(id);
		q.AddProduct(ID,Name,type,number,Descrption,PicturePath);
		q.CloseConnect();
		q.closeData();
		}catch(Exception e) {
			e.printStackTrace();
		}
		response.sendRedirect("FindServlet");           //重定向到FindServlet
	}

	/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		// TODO Auto-generated method stub
		doGet(request, response);
	}

}

